import openpyxl

def fix_mojibake(text: str) -> str:
    if not isinstance(text, str):
        return text
    replacements = {
        "â€™": "’",  # apostrophe
        "â€œ": "“",
        "â€�": "”",
        "â€“": "–",  # en dash
        "â€”": "—",  # em dash
        "â€¦": "…",
        "â€": "”",  # sometimes stray quotes
    }
    for bad, good in replacements.items():
        text = text.replace(bad, good)
    return text

# Load and fix workbook
wb = openpyxl.load_workbook("input.xlsx")
for sheet in wb.sheetnames:
    ws = wb[sheet]
    for row in ws.iter_rows():
        for cell in row:
            if isinstance(cell.value, str):
                cell.value = fix_mojibake(cell.value)

wb.save("fixed.xlsx")
