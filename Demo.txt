from fastapi import FastAPI, Depends
from auth import get_current_user

app = FastAPI()

@app.get("/secure-data")
async def secure_get(user: dict = Depends(get_current_user)):
    return {
        "message": "GET access granted",
        "user_id": user["user_id"],
        "username": user["username"]
    }

@app.post("/secure-action")
async def secure_post(data: dict, user: dict = Depends(get_current_user)):
    return {
        "message": "POST access granted",
        "user_id": user["user_id"],
        "data_received": data
    }
