import asyncpg
import asyncio

async def fetch_latest_version_value(record_id: int):
    conn = await asyncpg.connect(
        user="your_user",
        password="your_password",
        database="your_db",
        host="localhost",
        port=5432
    )
    
    query = """
        SELECT *
        FROM your_table
        WHERE id = $1
        ORDER BY version DESC
        LIMIT 1;
    """
    row = await conn.fetchrow(query, record_id)
    await conn.close()
    return row

async def main():
    latest_record = await fetch_latest_version_value(123)  # example id
    print(latest_record)

asyncio.run(main())
