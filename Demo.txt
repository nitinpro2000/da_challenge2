import msal

CLIENT_ID = "<your-client-id>"
TENANT_ID = "<your-tenant-id>"
AUTHORITY = f"https://login.microsoftonline.com/{TENANT_ID}"
SCOPES = ["api://<your-api-client-id>/.default"]  # or your scopes

app = msal.PublicClientApplication(client_id=CLIENT_ID, authority=AUTHORITY)

def get_valid_token():
    accounts = app.get_accounts()
    if accounts:
        result = app.acquire_token_silent(SCOPES, account=accounts[0])
        if result and "access_token" in result:
            return result["access_token"]
    # fallback to interactive login
    result = app.acquire_token_interactive(SCOPES)
    return result["access_token"]

token = get_valid_token()
print("Access Token:", token)
