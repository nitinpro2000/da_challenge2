import os
from openai import AzureOpenAI

# Set up Azure OpenAI client
client = AzureOpenAI(
    api_key=os.getenv("AZURE_OPENAI_API_KEY"),       # Your API key
    api_version="2024-02-01",                        # API version
    azure_endpoint=os.getenv("AZURE_OPENAI_ENDPOINT") # e.g., "https://<your-resource>.openai.azure.com/"
)

def get_industry_from_company(company_name: str) -> str:
    """
    Get the industry name for a given company using Azure OpenAI.
    """
    system_prompt = (
        "You are a precise corporate classification assistant. "
        "Given a company name, respond with only its primary industry "
        "category (e.g., 'Banking', 'Pharmaceuticals', 'Technology', 'Automotive'). "
        "Do not include extra text, explanations, or multiple industries."
    )

    user_prompt = f"Company name: {company_name}\nIndustry:"

    response = client.chat.completions.create(
        model="gpt-4o",  # Change to your Azure OpenAI deployment name
        messages=[
            {"role": "system", "content": system_prompt},
            {"role": "user", "content": user_prompt}
        ],
        temperature=0,  # Keep deterministic for consistent results
        max_tokens=20
    )

    industry = response.choices[0].message.content.strip()
    return industry


if __name__ == "__main__":
    # Example usage
    company = "Microsoft"
    industry = get_industry_from_company(company)
    print(f"Company: {company}\nIndustry: {industry}")
