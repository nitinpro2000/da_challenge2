import snowflake.connector

# Use your OAuth access token
access_token = "<your_access_token>"

conn = snowflake.connector.connect(
    account="<your_account>.snowflakecomputing.com",
    authenticator="oauth",
    token=access_token,
    warehouse="<your_warehouse>",
    database="<your_database>",
    schema="<your_schema>",
    role="<your_role>"  # Optional
)

cur = conn.cursor()
cur.execute("SELECT CURRENT_USER(), CURRENT_ROLE(), CURRENT_REGION()")
print(cur.fetchall())
cur.close()
conn.close()
