from typing import Dict, List, Any

def update_client_overview_and_nba(
    sources_dict: Dict[str, List[Dict[str, Any]]],
    decision_flags: Dict[str, bool]
) -> None:
    for section_key in ["client overview", "next_best_actions"]:
        if section_key not in sources_dict:
            continue

        if not decision_flags.get("call_reports", True) and section_key in sources_dict:
            # Remove cle_dev.documents if call reports is False
            sources_dict[section_key] = [
                row for row in sources_dict[section_key]
                if row["name"] != "cle_dev.documents"
            ]

        new_rows = []
        for row in sources_dict[section_key]:
            # If filtering by section
            if row.get("filter_section", False):
                original_values = row.get("section_values", [])
                # Remove section values based on which content is disabled
                allowed = []
                for val in original_values:
                    val_key = val.replace(" ", "_").lower()  # e.g., "company_news"
                    if decision_flags.get(val_key, True):
                        allowed.append(val)

                if allowed:
                    row["section_values"] = allowed
                    new_rows.append(row)
                # If no section values remain, skip row
            else:
                # No section filtering, just keep the row
                new_rows.append(row)

        # If no rows left, remove entire section
        if new_rows:
            sources_dict[section_key] = new_rows
        else:
            del sources_dict[section_key]
