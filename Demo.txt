import asyncpg
from typing import Optional

# This will hold the pool object
db_pool: Optional[asyncpg.pool.Pool] = None

async def init_db_pool():
    global db_pool
    if db_pool is None:
        db_pool = await asyncpg.create_pool(
            dsn="postgresql://user:password@host:port/dbname",
            min_size=1,
            max_size=10
        )

async def get_db_connection():
    if db_pool is None:
        raise RuntimeError("Database pool is not initialized.")
    return await db_pool.acquire()

async def release_db_connection(conn):
    await db_pool.release(conn)
